# @cwj/auth è®¤è¯åŒ…æ–‡æ¡£

## ğŸ“– æ¦‚è¿°

`@cwj/auth` æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è®¤è¯æˆæƒåŒ…,ä¸ºå¾®å‰ç«¯åº”ç”¨æä¾›ç»Ÿä¸€çš„è®¤è¯èƒ½åŠ›ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **Token ç®¡ç†**: Cookie å­˜å‚¨,åˆ©ç”¨æµè§ˆå™¨åŒæºç­–ç•¥è‡ªåŠ¨æºå¸¦
- âœ… **URL æ‹¦æˆª**: é¡µé¢åŠ è½½æ—¶æ£€æµ‹ Token,æ—  Token è‡ªåŠ¨è·³è½¬ç™»å½•
- âœ… **XHR æ‹¦æˆª**: ç»Ÿä¸€æ‹¦æˆªæ‰€æœ‰ HTTP è¯·æ±‚,å¤„ç†ä¸šåŠ¡çŠ¶æ€ç 
- âœ… **æƒé™æ§åˆ¶**: æä¾›è·¯ç”±çº§å’ŒæŒ‰é’®çº§æƒé™åˆ¤æ–­
- âœ… **æ¡†æ¶æ— å…³**: æ ¸å¿ƒåŠŸèƒ½ä¸ä¾èµ– Vue Router,å¯åœ¨ä»»ä½•æ¡†æ¶ä¸­ä½¿ç”¨
- âœ… **TypeScript**: å®Œæ•´çš„ç±»å‹å®šä¹‰

## ğŸ“¦ å®‰è£…

```bash
# ä½¿ç”¨ pnpm
pnpm add @cwj/auth

# ä½¿ç”¨ npm
npm install @cwj/auth

# ä½¿ç”¨ yarn
yarn add @cwj/auth
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€é…ç½®

```typescript
// main.ts
import { createApp } from 'vue'
import { createAuth, setupUrlGuard, setupXhrInterceptor } from '@cwj/auth'
import App from './App.vue'

const app = createApp(App)

// 1. åˆ›å»ºè®¤è¯å®ä¾‹
const auth = createAuth({
  loginUrl: 'https://xx.xxx.com/account/',
  storage: 'cookie',
  tokenKey: 'access_token',
  cookieOptions: {
    domain: '.xxx.com',
    path: '/',
    secure: true,
    sameSite: 'Lax',
  },
})

app.use(auth)

// 2. åˆå§‹åŒ– URL æ‹¦æˆªå™¨(é¡µé¢åŠ è½½æ—¶æ£€æµ‹ Token)
setupUrlGuard({
  loginUrl: 'https://xx.xxx.com/account/',
  whitelist: ['/about', '/help'],
})

// 3. åˆå§‹åŒ– XHR æ‹¦æˆªå™¨(æ‹¦æˆªæ‰€æœ‰ HTTP è¯·æ±‚)
setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
})

app.mount('#app')
```

## ğŸ“š API æ–‡æ¡£

### createAuth()

åˆ›å»ºè®¤è¯å®ä¾‹å¹¶æ³¨å†Œä¸º Vue æ’ä»¶ã€‚

**ç±»å‹ç­¾å:**

```typescript
function createAuth(options: AuthOptions): Plugin
```

**å‚æ•°:**

```typescript
interface AuthOptions {
  loginUrl: string // ç™»å½•é¡µåœ°å€
  storage: 'cookie' // å­˜å‚¨æ–¹å¼
  tokenKey?: string // Token é”®å,é»˜è®¤ 'access_token'
  cookieOptions?: CookieOptions // Cookie é…ç½®
}

interface CookieOptions {
  domain?: string // Cookie åŸŸå,å¦‚ '.xxx.com'
  path?: string // Cookie è·¯å¾„,é»˜è®¤ '/'
  secure?: boolean // æ˜¯å¦ä»… HTTPS,é»˜è®¤ true
  sameSite?: 'Strict' | 'Lax' | 'None' // é»˜è®¤ 'Lax'
  maxAge?: number // è¿‡æœŸæ—¶é—´(ç§’)
}
```

**ç¤ºä¾‹:**

```typescript
const auth = createAuth({
  loginUrl: 'https://xx.xxx.com/account/',
  storage: 'cookie',
  tokenKey: 'access_token',
  cookieOptions: {
    domain: '.xxx.com',
    path: '/',
    secure: true,
    sameSite: 'Lax',
  },
})

app.use(auth)
```

### useAuth()

è·å–è®¤è¯çŠ¶æ€å’Œæ–¹æ³•çš„ Composableã€‚

**ç±»å‹ç­¾å:**

```typescript
function useAuth(): {
  token: Ref<string | null>
  isAuthenticated: ComputedRef<boolean>
  userInfo: Ref<UserInfo | null>
  setToken: (token: string) => void
  getToken: () => string | null
  clearToken: () => void
  logout: () => void
  redirectToLogin: (redirect?: string) => void
}
```

**è¿”å›å€¼:**

| å±æ€§              | ç±»å‹                          | è¯´æ˜                    |
| ----------------- | ----------------------------- | ----------------------- |
| `token`           | `Ref<string \| null>`         | Token å“åº”å¼å¼•ç”¨        |
| `isAuthenticated` | `ComputedRef<boolean>`        | æ˜¯å¦å·²è®¤è¯              |
| `userInfo`        | `Ref<UserInfo \| null>`       | ç”¨æˆ·ä¿¡æ¯                |
| `setToken`        | `(token: string) => void`     | è®¾ç½® Token              |
| `getToken`        | `() => string \| null`        | è·å– Token              |
| `clearToken`      | `() => void`                  | æ¸…é™¤ Token              |
| `logout`          | `() => void`                  | ç™»å‡º(æ¸…é™¤ Token å¹¶è·³è½¬) |
| `redirectToLogin` | `(redirect?: string) => void` | è·³è½¬åˆ°ç™»å½•é¡µ            |

**ç¤ºä¾‹:**

```typescript
<script setup lang="ts">
import { useAuth } from '@cwj/auth'

const { token, isAuthenticated, setToken, logout } = useAuth()

// è·å– Token
console.log(token.value)

// æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
if (isAuthenticated.value) {
  console.log('å·²ç™»å½•')
}

// ç™»å‡º
function handleLogout() {
  logout()
}
</script>
```

### setupUrlGuard()

è®¾ç½® URL æ‹¦æˆªå™¨,åœ¨é¡µé¢åŠ è½½æ—¶æ£€æµ‹ Tokenã€‚

**ç±»å‹ç­¾å:**

```typescript
function setupUrlGuard(options: UrlGuardOptions): void
```

**å‚æ•°:**

```typescript
interface UrlGuardOptions {
  loginUrl: string // ç™»å½•é¡µåœ°å€
  whitelist?: string[] // ç™½åå•è·¯å¾„
  onNoToken?: () => void // æ—  Token æ—¶çš„å›è°ƒ
}
```

**ç¤ºä¾‹:**

```typescript
setupUrlGuard({
  loginUrl: 'https://xx.xxx.com/account/',
  whitelist: ['/about', '/help', '/public'],
  onNoToken: () => {
    console.log('æœªç™»å½•,è·³è½¬åˆ°ç™»å½•é¡µ')
  },
})
```

**å·¥ä½œåŸç†:**

1. é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ
2. æ£€æŸ¥å½“å‰è·¯å¾„æ˜¯å¦åœ¨ç™½åå•ä¸­
3. å¦‚æœä¸åœ¨ç™½åå•,æ£€æµ‹ Cookie ä¸­çš„ Token
4. æ—  Token åˆ™è·³è½¬åˆ°ç™»å½•é¡µ,å¹¶æºå¸¦ `redirect` å‚æ•°

### setupXhrInterceptor()

è®¾ç½® XHR æ‹¦æˆªå™¨,æ‹¦æˆªæ‰€æœ‰ HTTP è¯·æ±‚ã€‚

**ç±»å‹ç­¾å:**

```typescript
function setupXhrInterceptor(options: XhrInterceptorOptions): void
```

**å‚æ•°:**

```typescript
interface XhrInterceptorOptions {
  loginUrl: string // ç™»å½•é¡µåœ°å€
  tokenExpiredCode?: number // Token è¿‡æœŸçš„ä¸šåŠ¡çŠ¶æ€ç ,é»˜è®¤ 10001
  onTokenExpired?: () => void // Token è¿‡æœŸæ—¶çš„å›è°ƒ
}
```

**ç¤ºä¾‹:**

```typescript
setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
  onTokenExpired: () => {
    console.log('Token å·²è¿‡æœŸ')
    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å…¶ä»–é€»è¾‘,å¦‚æ¸…ç†æœ¬åœ°æ•°æ®
  },
})
```

**å·¥ä½œåŸç†:**

1. æ‹¦æˆª `XMLHttpRequest` å’Œ `Fetch API`
2. Cookie è‡ªåŠ¨æºå¸¦(æµè§ˆå™¨è¡Œä¸º,æ— éœ€æ‰‹åŠ¨æ·»åŠ )
3. å“åº”æ‹¦æˆª:æ£€æµ‹ä¸šåŠ¡çŠ¶æ€ç 
4. å¦‚æœ `code === 10001`,æ¸…é™¤ Cookie å¹¶è·³è½¬ç™»å½•

### usePermission()

æƒé™åˆ¤æ–­ Composableã€‚

**ç±»å‹ç­¾å:**

```typescript
function usePermission(): {
  hasPermission: (permission: string) => boolean
  hasAnyPermission: (permissions: string[]) => boolean
  hasAllPermissions: (permissions: string[]) => boolean
}
```

**è¿”å›å€¼:**

| æ–¹æ³•                | ç±»å‹                                 | è¯´æ˜         |
| ------------------- | ------------------------------------ | ------------ |
| `hasPermission`     | `(permission: string) => boolean`    | æ£€æŸ¥å•ä¸ªæƒé™ |
| `hasAnyPermission`  | `(permissions: string[]) => boolean` | æ£€æŸ¥ä»»æ„æƒé™ |
| `hasAllPermissions` | `(permissions: string[]) => boolean` | æ£€æŸ¥æ‰€æœ‰æƒé™ |

**ç¤ºä¾‹:**

```typescript
<script setup lang="ts">
import { usePermission } from '@cwj/auth'

const { hasPermission, hasAnyPermission } = usePermission()

// æ£€æŸ¥å•ä¸ªæƒé™
const canEdit = hasPermission('user.edit')

// æ£€æŸ¥ä»»æ„æƒé™
const canManage = hasAnyPermission(['user.edit', 'user.delete'])
</script>

<template>
  <button v-if="canEdit">ç¼–è¾‘</button>
  <button v-if="canManage">ç®¡ç†</button>
</template>
```

### authGuard()

Vue Router è®¤è¯å®ˆå«(å¯é€‰)ã€‚

**ç±»å‹ç­¾å:**

```typescript
function authGuard(options: AuthGuardOptions): NavigationGuard
```

**å‚æ•°:**

```typescript
interface AuthGuardOptions {
  loginUrl: string // ç™»å½•é¡µåœ°å€
  whitelist?: string[] // ç™½åå•è·¯ç”±
}
```

**ç¤ºä¾‹:**

```typescript
import { createRouter } from 'vue-router'
import { authGuard } from '@cwj/auth'

const router = createRouter({
  // ... routes
})

router.beforeEach(
  authGuard({
    loginUrl: 'https://xx.xxx.com/account/',
    whitelist: ['/about', '/help'],
  })
)
```

### v-permission æŒ‡ä»¤

æƒé™æ§åˆ¶æŒ‡ä»¤ã€‚

**ç”¨æ³•:**

```vue
<template>
  <!-- å•ä¸ªæƒé™ -->
  <button v-permission="'user.edit'">ç¼–è¾‘</button>

  <!-- ä»»æ„æƒé™ -->
  <button v-permission:any="['user.edit', 'user.delete']">æ“ä½œ</button>

  <!-- æ‰€æœ‰æƒé™ -->
  <button v-permission:all="['user.read', 'user.edit']">é«˜çº§æ“ä½œ</button>
</template>
```

## ğŸ” Token ç®¡ç†

### Cookie å­˜å‚¨

Token å­˜å‚¨åœ¨ Cookie ä¸­,åˆ©ç”¨æµè§ˆå™¨çš„åŒæºç­–ç•¥è‡ªåŠ¨æºå¸¦ã€‚

**ä¼˜åŠ¿:**

- âœ… æµè§ˆå™¨è‡ªåŠ¨æºå¸¦(åŒæºè¯·æ±‚)
- âœ… æ”¯æŒè·¨å­åº”ç”¨å…±äº«
- âœ… å¯è®¾ç½® `HttpOnly` é˜²æ­¢ XSS(åç«¯è®¾ç½®)
- âœ… å¯è®¾ç½® `Secure` ä»… HTTPS ä¼ è¾“
- âœ… å¯è®¾ç½® `SameSite` é˜²æ­¢ CSRF

**é…ç½®ç¤ºä¾‹:**

```typescript
cookieOptions: {
  domain: '.xxx.com',    // æ”¯æŒæ‰€æœ‰å­åŸŸå
  path: '/',
  secure: true,          // ä»… HTTPS
  sameSite: 'Lax',       // é˜²æ­¢ CSRF
}
```

**åŸŸåè¯´æ˜:**

```
domain: '.xxx.com'

æ”¯æŒçš„åŸŸå:
âœ… xx.xxx.com (ä¸»åº”ç”¨)
âœ… xx.xxx.com/designer (è®¾è®¡å™¨)
âœ… xx.xxx.com/renderer (æ¸²æŸ“å™¨)
âœ… xx.xxx.com/admin (ç®¡ç†åå°)
âœ… xx.xxx.com/account (è´¦å·ä¸­å¿ƒ)

Cookie è‡ªåŠ¨å…±äº«,æ— éœ€æ‰‹åŠ¨ä¼ é€’
```

### Token æ“ä½œ

```typescript
import { useAuth } from '@cwj/auth'

const { setToken, getToken, clearToken } = useAuth()

// è®¾ç½® Token(ç™»å½•æˆåŠŸå)
setToken('your-jwt-token')
// è‡ªåŠ¨å†™å…¥ Cookie:
// document.cookie = 'access_token=xxx; domain=.xxx.com; path=/; secure; samesite=Lax'

// è·å– Token
const token = getToken()
console.log(token)

// æ¸…é™¤ Token(ç™»å‡º)
clearToken()
// è‡ªåŠ¨åˆ é™¤ Cookie:
// document.cookie = 'access_token=; domain=.xxx.com; path=/; max-age=0'
```

## ğŸ›¡ï¸ è®¤è¯æµç¨‹

### 1. ç”¨æˆ·ç™»å½•(account ç«™ç‚¹)

```typescript
// account ç«™ç‚¹ - ç™»å½•é¡µé¢
import { useAuth } from '@cwj/auth'

const { setToken } = useAuth()

async function handleLogin() {
  try {
    // è°ƒç”¨ç™»å½•æ¥å£
    const res = await loginApi({
      username: form.username,
      password: form.password,
    })

    // ä¿å­˜ Token åˆ° Cookie
    setToken(res.data.token)

    // è·³è½¬å›åŸé¡µé¢æˆ–é¦–é¡µ
    const redirect = new URLSearchParams(location.search).get('redirect')
    window.location.href = redirect || '/'
  } catch (error) {
    console.error('ç™»å½•å¤±è´¥:', error)
  }
}
```

### 2. ä¸»åº”ç”¨/å­åº”ç”¨è®¿é—®

```typescript
// main.ts
import { setupUrlGuard } from '@cwj/auth'

// åˆå§‹åŒ– URL æ‹¦æˆªå™¨
setupUrlGuard({
  loginUrl: 'https://xx.xxx.com/account/',
  whitelist: ['/about', '/help'],
})

// å·¥ä½œæµç¨‹:
// 1. é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ
// 2. æ£€æµ‹ Cookie ä¸­çš„ token
// 3. å¦‚æœæ²¡æœ‰ token,è‡ªåŠ¨è·³è½¬åˆ° account
// 4. å¦‚æœæœ‰ token,æ­£å¸¸åŠ è½½é¡µé¢
```

### 3. Token è¿‡æœŸå¤„ç†

```typescript
// main.ts
import { setupXhrInterceptor } from '@cwj/auth'

// åˆå§‹åŒ– XHR æ‹¦æˆªå™¨
setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
})

// å·¥ä½œæµç¨‹:
// 1. æ‹¦æˆªæ‰€æœ‰ HTTP è¯·æ±‚
// 2. Cookie è‡ªåŠ¨æºå¸¦(æµè§ˆå™¨è¡Œä¸º)
// 3. å“åº”æ‹¦æˆª:æ£€æµ‹ä¸šåŠ¡çŠ¶æ€ç 
// 4. å¦‚æœ code === 10001,æ¸…é™¤ Cookie å¹¶è·³è½¬ç™»å½•
```

### 4. åç«¯æ¥å£å“åº”æ ¼å¼

```typescript
// æˆåŠŸå“åº”
{
  "code": 200,
  "message": "success",
  "data": { ... }
}

// Token è¿‡æœŸ(ä¸šåŠ¡çŠ¶æ€ç  10001)
{
  "code": 10001,
  "message": "Token å·²è¿‡æœŸ",
  "data": null
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ä¸»åº”ç”¨é›†æˆ

```typescript
// src/main.ts
import { createAuth, setupUrlGuard, setupXhrInterceptor } from '@cwj/auth'

const auth = createAuth({
  loginUrl: 'https://xx.xxx.com/account/',
  storage: 'cookie',
  cookieOptions: {
    domain: '.xxx.com',
    path: '/',
    secure: true,
    sameSite: 'Lax',
  },
})

app.use(auth)

setupUrlGuard({
  loginUrl: 'https://xx.xxx.com/account/',
  whitelist: ['/about'],
})

setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
})
```

### åœºæ™¯ 2: å­åº”ç”¨é›†æˆ(ç‹¬ç«‹è®¿é—®)

```typescript
// @cwj/designer/src/main.ts
import { createAuth, setupUrlGuard, setupXhrInterceptor } from '@cwj/auth'

const auth = createAuth({
  loginUrl: 'https://xx.xxx.com/account/',
  storage: 'cookie',
  cookieOptions: {
    domain: '.xxx.com',
    path: '/',
    secure: true,
    sameSite: 'Lax',
  },
})

app.use(auth)

// ç‹¬ç«‹è®¿é—®æ—¶:
// 1. URL æ‹¦æˆªå™¨æ£€æµ‹ Cookie ä¸­çš„ token
// 2. å¦‚æœæ²¡æœ‰ token,è‡ªåŠ¨è·³è½¬åˆ° account ç™»å½•
// 3. ç™»å½•æˆåŠŸå,account è®¾ç½® Cookie å¹¶è·³è½¬å›æ¥
// 4. Cookie è‡ªåŠ¨åœ¨æ‰€æœ‰å­åº”ç”¨é—´å…±äº«

setupUrlGuard({
  loginUrl: 'https://xx.xxx.com/account/',
})

setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
})
```

### åœºæ™¯ 3: è·¯ç”±çº§æƒé™æ§åˆ¶

```typescript
// router/index.ts
import { createRouter } from 'vue-router'
import { authGuard, permissionGuard } from '@cwj/auth'

const router = createRouter({
  // ... routes
})

// è®¤è¯å®ˆå«
router.beforeEach(
  authGuard({
    loginUrl: 'https://xx.xxx.com/account/',
    whitelist: ['/about', '/help'],
  })
)

// æƒé™å®ˆå«
router.beforeEach(
  permissionGuard({
    getPermissions: route => route.meta.permissions,
    onDenied: () => {
      router.push('/403')
    },
  })
)
```

### åœºæ™¯ 4: æŒ‰é’®çº§æƒé™æ§åˆ¶

```vue
<script setup lang="ts">
import { usePermission } from '@cwj/auth'

const { hasPermission, hasAnyPermission } = usePermission()

const canEdit = hasPermission('user.edit')
const canDelete = hasPermission('user.delete')
const canManage = hasAnyPermission(['user.edit', 'user.delete'])
</script>

<template>
  <div>
    <button v-if="canEdit">ç¼–è¾‘</button>
    <button v-if="canDelete">åˆ é™¤</button>
    <button v-if="canManage">ç®¡ç†</button>

    <!-- æˆ–ä½¿ç”¨æŒ‡ä»¤ -->
    <button v-permission="'user.edit'">ç¼–è¾‘</button>
    <button v-permission:any="['user.edit', 'user.delete']">æ“ä½œ</button>
  </div>
</template>
```

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰ Cookie é…ç½®

```typescript
const auth = createAuth({
  loginUrl: 'https://xx.xxx.com/account/',
  storage: 'cookie',
  tokenKey: 'my_token', // è‡ªå®šä¹‰ Token é”®å
  cookieOptions: {
    domain: '.xxx.com',
    path: '/',
    secure: true,
    sameSite: 'Strict', // æ›´ä¸¥æ ¼çš„ CSRF é˜²æŠ¤
    maxAge: 7 * 24 * 60 * 60, // 7 å¤©è¿‡æœŸ
  },
})
```

### è‡ªå®šä¹‰ Token è¿‡æœŸå¤„ç†

```typescript
setupXhrInterceptor({
  loginUrl: 'https://xx.xxx.com/account/',
  tokenExpiredCode: 10001,
  onTokenExpired: () => {
    // è‡ªå®šä¹‰å¤„ç†é€»è¾‘
    console.log('Token å·²è¿‡æœŸ')

    // æ¸…ç†æœ¬åœ°æ•°æ®
    localStorage.clear()
    sessionStorage.clear()

    // æ˜¾ç¤ºæç¤º
    ElMessage.warning('ç™»å½•å·²è¿‡æœŸ,è¯·é‡æ–°ç™»å½•')
  },
})
```

## ğŸ“ ç±»å‹å®šä¹‰

```typescript
// è®¤è¯é…ç½®
interface AuthOptions {
  loginUrl: string
  storage: 'cookie'
  tokenKey?: string
  cookieOptions?: CookieOptions
}

// Cookie é…ç½®
interface CookieOptions {
  domain?: string
  path?: string
  secure?: boolean
  sameSite?: 'Strict' | 'Lax' | 'None'
  maxAge?: number
}

// ç”¨æˆ·ä¿¡æ¯
interface UserInfo {
  id: number
  name: string
  email: string
  avatar?: string
  roles?: string[]
  permissions?: string[]
}

// URL æ‹¦æˆªå™¨é…ç½®
interface UrlGuardOptions {
  loginUrl: string
  whitelist?: string[]
  onNoToken?: () => void
}

// XHR æ‹¦æˆªå™¨é…ç½®
interface XhrInterceptorOptions {
  loginUrl: string
  tokenExpiredCode?: number
  onTokenExpired?: () => void
}
```

## â“ å¸¸è§é—®é¢˜

### 1. Cookie ä¸å…±äº«?

**æ£€æŸ¥ Cookie é…ç½®:**

```typescript
cookieOptions: {
  domain: '.xxx.com',  // å¿…é¡»è®¾ç½®ä¸º .xxx.com
  path: '/',
}
```

**æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°:**

æ‰“å¼€ `Application -> Cookies` æŸ¥çœ‹ Cookie é…ç½®ã€‚

### 2. Token è¿‡æœŸåæ²¡æœ‰è·³è½¬?

**æ£€æŸ¥åç«¯å“åº”æ ¼å¼:**

```json
{
  "code": 10001, // å¿…é¡»æ˜¯ä¸šåŠ¡çŠ¶æ€ç ,ä¸æ˜¯ HTTP çŠ¶æ€ç 
  "message": "Token å·²è¿‡æœŸ"
}
```

**æ£€æŸ¥æ‹¦æˆªå™¨é…ç½®:**

```typescript
setupXhrInterceptor({
  tokenExpiredCode: 10001, // ç¡®ä¿ä¸åç«¯ä¸€è‡´
})
```

### 3. ç™½åå•ä¸ç”Ÿæ•ˆ?

**æ£€æŸ¥è·¯å¾„åŒ¹é…:**

```typescript
setupUrlGuard({
  whitelist: ['/about', '/help'], // ä½¿ç”¨ startsWith åŒ¹é…
})

// åŒ¹é…è§„åˆ™:
// âœ… /about -> åŒ¹é…
// âœ… /about/detail -> åŒ¹é…
// âŒ /user/about -> ä¸åŒ¹é…
```

## ğŸ“š ç›¸å…³èµ„æº

- [é¡¹ç›®æ–‡æ¡£](../../README.md)
- [æ¶æ„è®¾è®¡](../æ¶æ„è®¾è®¡.md)
- [å¼€å‘æŒ‡å—](../å¼€å‘æŒ‡å—.md)
- [éƒ¨ç½²æ–‡æ¡£](../éƒ¨ç½²æ–‡æ¡£.md)

## ğŸ“„ License

MIT
