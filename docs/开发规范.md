# å¼€å‘è§„èŒƒ

## ğŸ“ ä»£ç è§„èŒƒ

### TypeScript è§„èŒƒ

#### ç±»å‹å®šä¹‰

```typescript
// âœ… æ¨è: ä½¿ç”¨ interface å®šä¹‰å¯¹è±¡ç±»å‹
interface User {
  id: number
  name: string
  email: string
}

// âœ… æ¨è: ä½¿ç”¨ type å®šä¹‰è”åˆç±»å‹ã€äº¤å‰ç±»å‹
type Status = 'pending' | 'success' | 'error'
type UserWithRole = User & { role: string }

// âŒ é¿å…: ä½¿ç”¨ any
const data: any = {} // ä¸æ¨è

// âœ… æ¨è: ä½¿ç”¨ unknown æˆ–å…·ä½“ç±»å‹
const data: unknown = {}
```

#### å‡½æ•°ç±»å‹

```typescript
// âœ… æ¨è: æ˜ç¡®å‚æ•°å’Œè¿”å›å€¼ç±»å‹
function getUserById(id: number): Promise<User> {
  return api.get(`/users/${id}`)
}

// âœ… æ¨è: ä½¿ç”¨ç®­å¤´å‡½æ•°ç±»å‹
const handleClick: (event: MouseEvent) => void = event => {
  console.log(event)
}

// âœ… æ¨è: ä½¿ç”¨æ³›å‹
function request<T>(url: string): Promise<T> {
  return fetch(url).then(res => res.json())
}
```

#### ç±»å‹å¯¼å…¥

```typescript
// âœ… æ¨è: ä½¿ç”¨ type å…³é”®å­—å¯¼å…¥ç±»å‹
import type { User, Role } from './types'
import { getUser } from './api'

// âŒ é¿å…: æ··åˆå¯¼å…¥
import { User, getUser } from './api'
```

### Vue è§„èŒƒ

#### ç»„ä»¶å‘½å

```typescript
// âœ… æ¨è: PascalCase å‘½å
// UserProfile.vue
export default defineComponent({
  name: 'UserProfile',
})

// âŒ é¿å…: kebab-case æˆ–å…¶ä»–å‘½å
// user-profile.vue
```

#### Props å®šä¹‰

```typescript
// âœ… æ¨è: ä½¿ç”¨ TypeScript å®šä¹‰ props
interface Props {
  userId: number
  userName: string
  isActive?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  isActive: true,
})

// âŒ é¿å…: ä½¿ç”¨è¿è¡Œæ—¶å£°æ˜
const props = defineProps({
  userId: Number,
  userName: String,
})
```

#### Emits å®šä¹‰

```typescript
// âœ… æ¨è: æ˜ç¡®å®šä¹‰ emits
interface Emits {
  (e: 'update:modelValue', value: string): void
  (e: 'submit', data: FormData): void
}

const emit = defineEmits<Emits>()

// âœ… ä½¿ç”¨
emit('update:modelValue', 'new value')
emit('submit', formData)
```

#### Composables

```typescript
// âœ… æ¨è: use å‰ç¼€å‘½å
// composables/useUser.ts
export function useUser() {
  const user = ref<User | null>(null)
  const loading = ref(false)

  async function fetchUser(id: number) {
    loading.value = true
    try {
      user.value = await getUserById(id)
    } finally {
      loading.value = false
    }
  }

  return {
    user: readonly(user),
    loading: readonly(loading),
    fetchUser,
  }
}
```

### æ–‡ä»¶å‘½å

```
âœ… æ¨è:
- UserProfile.vue       (ç»„ä»¶)
- useAuth.ts            (Composable)
- userApi.ts            (API)
- user.types.ts         (ç±»å‹)
- user.store.ts         (Store)
- user.utils.ts         (å·¥å…·)

âŒ é¿å…:
- user-profile.vue
- auth.ts
- api.ts
- types.ts
```

## ğŸ“‚ ç›®å½•ç»“æ„è§„èŒƒ

### åº”ç”¨ç›®å½•ç»“æ„

```
@cwj/xxx/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ common/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ business/        # ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ views/               # é¡µé¢
â”‚   â”œâ”€â”€ router/              # è·¯ç”±
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ store/               # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ modules/
â”‚   â”œâ”€â”€ api/                 # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ modules/
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ composables/         # ç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ types/               # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ fonts/
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ public/                  # å…¬å…±èµ„æº
â”œâ”€â”€ webpack.config.ts        # Webpack é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â””â”€â”€ package.json
```

### npm åŒ…ç›®å½•ç»“æ„

```
@cwj/xxx/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts             # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ types/               # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”œâ”€â”€ docs/                    # æ–‡æ¡£(VitePress)
â”‚   â”œâ”€â”€ .vitepress/
â”‚   â”œâ”€â”€ guide/
â”‚   â””â”€â”€ api/
â”œâ”€â”€ dist/                    # æ„å»ºäº§ç‰©
â”‚   â”œâ”€â”€ index.mjs            # ESM
â”‚   â”œâ”€â”€ index.cjs            # CommonJS
â”‚   â””â”€â”€ index.d.ts           # ç±»å‹å®šä¹‰
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsup.config.ts           # æ„å»ºé…ç½®
â””â”€â”€ package.json
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### CSS å‘½å (BEM)

```vue
<template>
  <div class="user-card">
    <div class="user-card__header">
      <h3 class="user-card__title">{{ user.name }}</h3>
    </div>
    <div class="user-card__body">
      <p class="user-card__text">{{ user.bio }}</p>
    </div>
    <div class="user-card__footer">
      <button class="user-card__button user-card__button--primary">å…³æ³¨</button>
    </div>
  </div>
</template>

<style scoped>
/* Block */
.user-card {
  border: 1px solid #ddd;
}

/* Element */
.user-card__header {
  padding: 16px;
}

.user-card__title {
  font-size: 18px;
}

/* Modifier */
.user-card__button--primary {
  background-color: #409eff;
  color: white;
}
</style>
```

### CSS å˜é‡

```css
/* å…¨å±€å˜é‡ */
:root {
  /* é¢œè‰² */
  --color-primary: #409eff;
  --color-success: #67c23a;
  --color-warning: #e6a23c;
  --color-danger: #f56c6c;
  --color-info: #909399;

  /* é—´è· */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  /* å­—ä½“ */
  --font-size-sm: 12px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;

  /* åœ†è§’ */
  --border-radius-sm: 2px;
  --border-radius-md: 4px;
  --border-radius-lg: 8px;
}

/* ä½¿ç”¨å˜é‡ */
.button {
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: var(--font-size-md);
  border-radius: var(--border-radius-md);
  background-color: var(--color-primary);
}
```

### Scoped æ ·å¼

```vue
<style scoped>
/* âœ… æ¨è: ä½¿ç”¨ scoped é¿å…æ ·å¼æ±¡æŸ“ */
.user-card {
  padding: 16px;
}

/* âœ… æ·±åº¦é€‰æ‹©å™¨ */
:deep(.el-input__inner) {
  border-color: #409eff;
}

/* âœ… å…¨å±€æ ·å¼ */
:global(.custom-class) {
  color: red;
}
</style>
```

## ğŸ“‹ æ³¨é‡Šè§„èŒƒ

### æ–‡ä»¶æ³¨é‡Š

```typescript
/**
 * ç”¨æˆ·è®¤è¯ç›¸å…³åŠŸèƒ½
 * @module auth
 * @description æä¾›ç”¨æˆ·ç™»å½•ã€ç™»å‡ºã€æƒé™éªŒè¯ç­‰åŠŸèƒ½
 * @author Your Name
 * @created 2024-01-01
 */
```

### å‡½æ•°æ³¨é‡Š

````typescript
/**
 * è·å–ç”¨æˆ·ä¿¡æ¯
 * @param userId - ç”¨æˆ· ID
 * @returns ç”¨æˆ·ä¿¡æ¯å¯¹è±¡
 * @throws {Error} å½“ç”¨æˆ·ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯
 * @example
 * ```ts
 * const user = await getUserById(123)
 * console.log(user.name)
 * ```
 */
async function getUserById(userId: number): Promise<User> {
  const response = await api.get(`/users/${userId}`)
  return response.data
}
````

### å¤æ‚é€»è¾‘æ³¨é‡Š

```typescript
// âœ… æ¨è: è§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·åš
// ä½¿ç”¨é˜²æŠ–é¿å…é¢‘ç¹è°ƒç”¨æ¥å£,æå‡æ€§èƒ½
const debouncedSearch = debounce(search, 300)

// âœ… æ¨è: è§£é‡Šå¤æ‚çš„ä¸šåŠ¡é€»è¾‘
// å½“ç”¨æˆ·è§’è‰²ä¸ºç®¡ç†å‘˜æ—¶,æ˜¾ç¤ºæ‰€æœ‰æ•°æ®
// å½“ç”¨æˆ·è§’è‰²ä¸ºæ™®é€šç”¨æˆ·æ—¶,åªæ˜¾ç¤ºè‡ªå·±çš„æ•°æ®
const filteredData = computed(() => {
  if (userRole.value === 'admin') {
    return allData.value
  }
  return allData.value.filter(item => item.userId === currentUserId.value)
})

// âŒ é¿å…: æ— æ„ä¹‰çš„æ³¨é‡Š
// å®šä¹‰å˜é‡
const count = ref(0)
```

## ğŸ”§ Git è§„èŒƒ

### åˆ†æ”¯å‘½å

```bash
# åŠŸèƒ½å¼€å‘
feature/user-management
feature/login-page

# Bug ä¿®å¤
fix/login-error
fix/style-issue

# ç´§æ€¥ä¿®å¤
hotfix/security-patch

# é‡æ„
refactor/auth-module

# æ–‡æ¡£
docs/api-documentation
```

### æäº¤ä¿¡æ¯

éµå¾ª Conventional Commits è§„èŒƒ:

```bash
# æ ¼å¼
<type>(<scope>): <subject>

# ç±»å‹
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ Bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´(ä¸å½±å“åŠŸèƒ½)
refactor: é‡æ„(ä¸æ˜¯æ–°åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®å¤)
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºå·¥å…·æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

# ç¤ºä¾‹
feat(auth): æ·»åŠ  OAuth ç™»å½•åŠŸèƒ½
fix(designer): ä¿®å¤æ‹–æ‹½ç»„ä»¶ä½ç½®é”™è¯¯
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
style(user): æ ¼å¼åŒ–ç”¨æˆ·ç®¡ç†ä»£ç 
refactor(api): é‡æ„ API è¯·æ±‚å°è£…
test(auth): æ·»åŠ è®¤è¯æ¨¡å—å•å…ƒæµ‹è¯•
chore(deps): å‡çº§ Vue åˆ° 3.5.0
```

### æäº¤æœ€ä½³å®è·µ

```bash
# âœ… æ¨è: å°è€Œé¢‘ç¹çš„æäº¤
git commit -m "feat(auth): æ·»åŠ ç™»å½•è¡¨å•ç»„ä»¶"
git commit -m "feat(auth): æ·»åŠ ç™»å½•éªŒè¯é€»è¾‘"
git commit -m "feat(auth): é›†æˆç™»å½• API"

# âŒ é¿å…: å¤§è€Œå…¨çš„æäº¤
git commit -m "feat(auth): å®Œæˆæ•´ä¸ªç™»å½•åŠŸèƒ½"

# âœ… æ¨è: æ¸…æ™°çš„æäº¤ä¿¡æ¯
git commit -m "fix(designer): ä¿®å¤æ‹–æ‹½æ—¶ç»„ä»¶ä½ç½®è®¡ç®—é”™è¯¯"

# âŒ é¿å…: æ¨¡ç³Šçš„æäº¤ä¿¡æ¯
git commit -m "fix: ä¿®å¤ bug"
git commit -m "update"
```

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### å•å…ƒæµ‹è¯•

```typescript
// UserProfile.spec.ts
import { mount } from '@vue/test-utils'
import { describe, it, expect } from 'vitest'
import UserProfile from './UserProfile.vue'

describe('UserProfile', () => {
  it('åº”è¯¥æ­£ç¡®æ¸²æŸ“ç”¨æˆ·å', () => {
    const wrapper = mount(UserProfile, {
      props: {
        user: {
          id: 1,
          name: 'John Doe',
          email: 'john@example.com',
        },
      },
    })

    expect(wrapper.find('.user-name').text()).toBe('John Doe')
  })

  it('ç‚¹å‡»ç¼–è¾‘æŒ‰é’®åº”è¯¥è§¦å‘ edit äº‹ä»¶', async () => {
    const wrapper = mount(UserProfile, {
      props: {
        user: { id: 1, name: 'John' },
      },
    })

    await wrapper.find('.edit-button').trigger('click')
    expect(wrapper.emitted('edit')).toBeTruthy()
  })
})
```

### æµ‹è¯•è¦†ç›–ç‡

```bash
# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pnpm run test:coverage

# ç›®æ ‡è¦†ç›–ç‡
- è¯­å¥è¦†ç›–ç‡: >= 80%
- åˆ†æ”¯è¦†ç›–ç‡: >= 75%
- å‡½æ•°è¦†ç›–ç‡: >= 80%
- è¡Œè¦†ç›–ç‡: >= 80%
```

## ğŸ“¦ åŒ…ç®¡ç†è§„èŒƒ

### package.json

```json
{
  "name": "@cwj/xxx",
  "version": "1.0.0",
  "description": "ç®€çŸ­æè¿°",
  "type": "module",
  "main": "./dist/index.cjs",
  "module": "./dist/index.mjs",
  "types": "./dist/index.d.ts",
  "exports": {
    ".": {
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs",
      "types": "./dist/index.d.ts"
    }
  },
  "files": ["dist"],
  "scripts": {
    "dev": "tsup --watch",
    "build": "tsup",
    "type-check": "tsc --noEmit",
    "lint": "eslint .",
    "test": "vitest"
  },
  "keywords": ["vue", "typescript"],
  "author": "Your Name",
  "license": "MIT"
}
```

### ä¾èµ–ç‰ˆæœ¬

```json
{
  "dependencies": {
    // âœ… æ¨è: ä½¿ç”¨ ^ å…è®¸å°ç‰ˆæœ¬æ›´æ–°
    "vue": "^3.5.0",

    // âœ… æ¨è: é”å®šä¸»ç‰ˆæœ¬å·
    "axios": "^1.6.0"
  },
  "devDependencies": {
    // âœ… æ¨è: å¼€å‘ä¾èµ–ä¹Ÿä½¿ç”¨ ^
    "typescript": "^5.3.0",
    "vite": "^5.0.0"
  }
}
```

## ğŸ”’ å®‰å…¨è§„èŒƒ

### æ•æ„Ÿä¿¡æ¯

```typescript
// âŒ é¿å…: ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
const apiKey = 'sk-1234567890abcdef'
const password = 'admin123'

// âœ… æ¨è: ä½¿ç”¨ç¯å¢ƒå˜é‡
const apiKey = import.meta.env.VITE_API_KEY
const password = import.meta.env.VITE_PASSWORD
```

### XSS é˜²æŠ¤

```vue
<template>
  <!-- âŒ é¿å…: ä½¿ç”¨ v-html æ¸²æŸ“ç”¨æˆ·è¾“å…¥ -->
  <div v-html="userInput"></div>

  <!-- âœ… æ¨è: ä½¿ç”¨æ–‡æœ¬æ’å€¼ -->
  <div>{{ userInput }}</div>

  <!-- âœ… æ¨è: å¿…é¡»ä½¿ç”¨ v-html æ—¶,å…ˆè¿›è¡Œæ¸…ç† -->
  <div v-html="sanitizeHtml(userInput)"></div>
</template>

<script setup lang="ts">
import DOMPurify from 'dompurify'

function sanitizeHtml(html: string) {
  return DOMPurify.sanitize(html)
}
</script>
```

### CSRF é˜²æŠ¤

```typescript
// âœ… æ¨è: ä½¿ç”¨ CSRF Token
axios.defaults.headers.common['X-CSRF-TOKEN'] = getCsrfToken()

// âœ… æ¨è: Cookie è®¾ç½® SameSite
cookieOptions: {
  sameSite: 'Lax', // æˆ– 'Strict'
  secure: true,
  httpOnly: true
}
```

## ğŸ“Š æ€§èƒ½è§„èŒƒ

### ç»„ä»¶æ‡’åŠ è½½

```typescript
// âœ… æ¨è: è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/user',
    component: () => import('./views/User.vue'),
  },
]

// âœ… æ¨è: ç»„ä»¶æ‡’åŠ è½½
const HeavyComponent = defineAsyncComponent(() => import('./components/HeavyComponent.vue'))
```

### é¿å…ä¸å¿…è¦çš„å“åº”å¼

```typescript
// âŒ é¿å…: å¤§æ•°æ®ä½¿ç”¨ ref/reactive
const largeData = ref(hugeArray)

// âœ… æ¨è: ä½¿ç”¨ shallowRef
const largeData = shallowRef(hugeArray)

// âœ… æ¨è: ä½¿ç”¨ markRaw æ ‡è®°ä¸éœ€è¦å“åº”å¼çš„æ•°æ®
const staticData = markRaw(largeObject)
```

### åˆ—è¡¨æ¸²æŸ“ä¼˜åŒ–

```vue
<template>
  <!-- âœ… æ¨è: ä½¿ç”¨ key -->
  <div v-for="item in list" :key="item.id">
    {{ item.name }}
  </div>

  <!-- âœ… æ¨è: è™šæ‹Ÿæ»šåŠ¨(å¤§åˆ—è¡¨) -->
  <VirtualList :items="largeList" :item-height="50">
    <template #default="{ item }">
      <div>{{ item.name }}</div>
    </template>
  </VirtualList>
</template>
```

## ğŸ“š æ–‡æ¡£è§„èŒƒ

### README.md

æ¯ä¸ªåŒ…å’Œåº”ç”¨éƒ½åº”è¯¥æœ‰æ¸…æ™°çš„ README:

```markdown
# @cwj/xxx

ç®€çŸ­æè¿°

## å®‰è£…

\`\`\`bash
pnpm add @cwj/xxx
\`\`\`

## ä½¿ç”¨

\`\`\`typescript
import { xxx } from '@cwj/xxx'
\`\`\`

## API

### xxx()

æè¿°

**å‚æ•°:**

- `param1` (type): æè¿°

**è¿”å›å€¼:**

- type: æè¿°

**ç¤ºä¾‹:**
\`\`\`typescript
const result = xxx(param1)
\`\`\`

## License

MIT
```

### ä»£ç ç¤ºä¾‹

````typescript
/**
 * ç¤ºä¾‹åº”è¯¥:
 * 1. ç®€æ´æ˜äº†
 * 2. å¯ä»¥ç›´æ¥è¿è¡Œ
 * 3. åŒ…å«å¸¸è§ç”¨ä¾‹
 */

// âœ… å¥½çš„ç¤ºä¾‹
/**
 * @example
 * ```ts
 * const { user, loading } = useUser()
 * await fetchUser(123)
 * console.log(user.value.name)
 * ```
 */

// âŒ ä¸å¥½çš„ç¤ºä¾‹
/**
 * @example
 * useUser() // ä¸å®Œæ•´
 */
````

## âœ… ä»£ç å®¡æŸ¥æ¸…å•

### æäº¤å‰æ£€æŸ¥

- [ ] ä»£ç å·²é€šè¿‡ TypeScript ç±»å‹æ£€æŸ¥
- [ ] ä»£ç å·²é€šè¿‡ ESLint æ£€æŸ¥
- [ ] ä»£ç å·²é€šè¿‡ Prettier æ ¼å¼åŒ–
- [ ] æ·»åŠ äº†å¿…è¦çš„æ³¨é‡Š
- [ ] æ·»åŠ äº†å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] æäº¤ä¿¡æ¯ç¬¦åˆè§„èŒƒ

### Code Review è¦ç‚¹

- [ ] ä»£ç é€»è¾‘æ­£ç¡®
- [ ] æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜
- [ ] æ²¡æœ‰å®‰å…¨éšæ‚£
- [ ] ä»£ç å¯è¯»æ€§å¥½
- [ ] ç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] æµ‹è¯•è¦†ç›–å……åˆ†
- [ ] æ–‡æ¡£å®Œæ•´æ¸…æ™°
